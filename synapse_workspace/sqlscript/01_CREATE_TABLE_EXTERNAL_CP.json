{
	"name": "01_CREATE_TABLE_EXTERNAL_CP",
	"properties": {
		"folder": {
			"name": "02_trabajo_final"
		},
		"content": {
			"query": "USE finalwork;\nGO\n\n--Creando la tabla hm_portafolio en el esquema master\n\n--DROP EXTERNAL TABLE master.hm_portafolio;\n\nCREATE EXTERNAL TABLE master.hm_portafolio(\n    CODMES\t        int,\n    PRODUCTO_RBM0\tvarchar(40),\n    CAT_DEPA\t    varchar(40),\n    CAT_EDAD\t    int,\n    CAT_GEN\t        int,\n    CTD_OPE\t        int,\n    SUM_MTOCPL\t    float,\n    SUM_MTOLIN\t    float,\n    CTD_MORA_30\t    int,\n    CTD_MORA_60\t    int,\n    CTD_MORA_90\t    int,\n    CTD_MORA_120\tint,\n    MTO_MORA_30\t    float,\n    MTO_MORA_60\t    float,\n    MTO_MORA_90\t    float,\n    MTO_MORA_120\tfloat\n) WITH (\n    LOCATION = '/master/data/creditportfolio/hm_portafolio/*',\n    DATA_SOURCE = UPExternalDataSource,\n    FILE_FORMAT = UPParquetFileFormat\n);\nGO\n\nSELECT * FROM master.hm_portafolio\n\n--Creando la tabla mm_cosechas en el esquema master\n\nCREATE EXTERNAL TABLE master.mm_cosechas(\n    CODMES\t        int,\n    PRODUCTO_RBM0\tvarchar(40),\n    CAT_DEPA\t    varchar(40),\n    CAT_EDAD\t    int,\n    CAT_GEN\t        int,\n    CTD_OPE\t        int,\n    SUM_MTOCPL\t    float,\n    SUM_MTOLIN\t    float\n) WITH (\n    LOCATION = '/master/data/creditportfolio/mm_cosechas/*',\n    DATA_SOURCE = UPExternalDataSource,\n    FILE_FORMAT = UPParquetFileFormat\n);\nGO\n\nSELECT * FROM master.mm_cosechas\n\nCREATE TABLE master.me_descatedad(\n    CAT_EDAD\t    int,\n    DES_CAT_EDAD    varchar(40)\n)\n\nINSERT INTO master.me_descatedad \nVALUES (1, '1. <--,18>'),\n(2, '2. [18, 30>'),\n(3, '3. [30, 45>'),\n(4, '4. [30, 45>'),\n(4, '5. [65, ++>'\nGO\n\n\n\n\nDROP EXTERNAL TABLE business.Badges\n\nSELECT TOP (10) *\nFrom OPENROWSET (BULK '/business/aggregate/*.parquet',\nDATA_SOURCE= 'UPExternalDataSource',\nFORMAT ='PARQUET') Â AS [file]\nGO;\n\n--creando la tabla correctamente con los tipos de datos\nCREATE EXTERNAL TABLE business.Badges01(\n    Id BIGINT,\n    Name nvarchar(150),\n    UserId INT\n) WITH (\n    LOCATION = '/business/aggregate/*',\n    DATA_SOURCE = UPExternalDataSource,\n    FILE_FORMAT = UPParquetFileFormat\n);\nGO\n\nSELECT * FROM business.Badges01\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "finalwork",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}